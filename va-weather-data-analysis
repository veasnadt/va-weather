import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

weather_data = pd.read_csv('va-weather-data.csv')
weather_data['DATE'] = pd.to_datetime(weather_data['DATE'])
weather_data_cleaned = weather_data[['DATE', 'TMAX', 'TMIN', 'PRCP', 'AWND']].dropna()
weather_data_cleaned['TEMP_RANGE'] = weather_data_cleaned['TMAX'] - weather_data_cleaned['TMIN']

plt.figure().clear()
plt.clf()
plt.close('all')

# visualize min and max temps over time
weather_data_cleaned = weather_data_cleaned.sort_values('DATE')
plt.figure(figsize=(12, 6))
plt.plot(weather_data_cleaned['DATE'], weather_data_cleaned['TMAX'], label='Max Temperature (TMAX)', color='red', alpha=0.7)
plt.plot(weather_data_cleaned['DATE'], weather_data_cleaned['TMIN'], label='Min Temperature (TMIN)', color='blue', alpha=0.7)
plt.title('Daily Maximum and Minimum Temperatures Over Time')
plt.xlabel('Date')
plt.ylabel('Temperature (째F)')
plt.legend()
plt.show()

# visualize precipitation levels over time
plt.figure(figsize=(12, 6))
plt.plot(weather_data_cleaned['DATE'], weather_data_cleaned['PRCP'], label='Precipitation (PRCP)', color='green', alpha=0.7)
plt.title('Daily Precipitation Levels Over Time')
plt.xlabel('Date')
plt.ylabel('Precipitation (inches)')
plt.legend()
plt.show()

# summary statistics for temperature and precipitation
monthly_trends = weather_data_cleaned.groupby(weather_data_cleaned['DATE'].dt.month).agg({
    'TMAX': 'mean',
    'TMIN': 'mean',
    'PRCP': 'sum'
}).reset_index()
monthly_trends.columns = ['Month', 'Avg Max Temp (째F)', 'Avg Min Temp (째F)', 'Total Precipitation (inches)']
print(monthly_trends)


# seasonal insights
def assign_season(month):
    if month in [12, 1, 2]:
        return 'Winter'
    elif month in [3, 4, 5]:
        return 'Spring'
    elif month in [6, 7, 8]:
        return 'Summer'
    else:
        return 'Fall'

weather_data_cleaned['Season'] = weather_data_cleaned['DATE'].dt.month.apply(assign_season)

# summary statistics for seasonal data
seasonal_data = weather_data_cleaned.groupby('Season').agg({
    'TMAX': 'mean',
    'TMIN': 'mean',
    'PRCP': 'sum'
}).reset_index()
print(seasonal_data)

# visualize seasonal temperature averages
plt.figure(figsize=(10, 6))
sns.barplot(data=seasonal_data, x='Season', y='TMAX', color='red', label='Avg Max Temp')
sns.barplot(data=seasonal_data, x='Season', y='TMIN', color='blue', label='Avg Min Temp', alpha=0.7)
plt.title('Seasonal Temperature Averages')
plt.ylabel('Temperature (째F)')
plt.xlabel('Season')
plt.legend()
plt.show()


# extremes
hottest_day = weather_data_cleaned.loc[weather_data_cleaned['TMAX'].idxmax()]
coldest_day = weather_data_cleaned.loc[weather_data_cleaned['TMIN'].idxmin()]
wettest_day = weather_data_cleaned.loc[weather_data_cleaned['PRCP'].idxmax()]

print("Hottest Day:", hottest_day)
print("Coldest Day:", coldest_day)
print("Wettest Day:", wettest_day)


